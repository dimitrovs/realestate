<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>The source code</title>
  <link href="../resources/prettify/prettify.css" type="text/css" rel="stylesheet" />
  <script type="text/javascript" src="../resources/prettify/prettify.js"></script>
  <style type="text/css">
    .highlight { display: block; background-color: #ddd; }
  </style>
  <script type="text/javascript">
    function highlight() {
      document.getElementById(location.hash.replace(/#/, "")).className = "highlight";
    }
  </script>
</head>
<body onload="prettyPrint(); highlight();">
  <pre class="prettyprint lang-js">// Generated by CoffeeScript 1.4.0
<span id='Phoenix-controller-ScenarioGridController'>/**
</span>* Controls the scenario grid.
*/

Ext.define(&quot;Phoenix.controller.ScenarioGridController&quot;, {
  extend: &quot;Phoenix.controller.AbstractPhoenixController&quot;,
<span id='Phoenix-controller-ScenarioGridController-property-observe'>  observe: {
</span>    scenarioContext: {
      initialDataLoaded: &quot;loadScenarios&quot;
    }
  },
<span id='Phoenix-controller-ScenarioGridController-property-control'>  control: {
</span>    view: {
      itemdblclick: &quot;onEditScenario&quot;
    },
    addButton: {
      click: &quot;onAddButtonClick&quot;
    },
    scenarioActionColumn: {
      click: &quot;onActionColumnClick&quot;
    }
  },
  config: {
<span id='Phoenix-controller-ScenarioGridController-cfg-uuidGenerator'>    uuidGenerator: new Ext.data.UuidGenerator()
</span>  },
<span id='Phoenix-controller-ScenarioGridController-method-init'>  init: function() {
</span>    return this.callParent(arguments);
  },
<span id='Phoenix-controller-ScenarioGridController-method-loadScenarios'>  /**
</span>  	* Loads the set of {Phoenix.model.Scenario} models
  */

  loadScenarios: function() {
    var _this = this;
    this.getView().setLoading(true);
    return this.getScenarioService().loadScenarios().then({
      failure: function(errorMessage) {
        return _this.getNotificationService().error(&quot;Error&quot;, errorMessage);
      }
    }).always(function() {
      return _this.getView().setLoading(false);
    });
  },
<span id='Phoenix-controller-ScenarioGridController-method-deleteScenario'>  /**
</span>  	* Deletes the passed {Phoenix.model.Scenario}.
  	* @param {Phoenix.model.Scenario} Scenario to delete.
  */

  deleteScenario: function(scenario) {
    var _this = this;
    this.getView().setLoading(true);
    return this.getScenarioService().deleteScenario(scenario).then({
      success: function() {
        _this.getScenarioContext().scenarioDeleted(scenario);
        return _this.getNotificationService().success(&quot;Success&quot;, &quot;The scenario was deleted successfully.&quot;);
      },
      failure: function() {
        return _this.getNotificationService().error(&quot;Error&quot;, &quot;Error deleting Scenario.&quot;);
      }
    }).always(function() {
      return _this.getView().setLoading(false);
    });
  },
<span id='Phoenix-controller-ScenarioGridController-method-onAddButtonClick'>  /**
</span>  	* Handles a click on the add button and opens a new Scenario view.
  */

  onAddButtonClick: function() {
    var scenario;
    scenario = Ext.create(&quot;Phoenix.model.Scenario&quot;, {
      id: this.getUuidGenerator().generate(),
      name: &quot;New Scenario&quot;
    });
    return this.getScenarioContext().scenarioOpened(scenario);
  },
<span id='Phoenix-controller-ScenarioGridController-method-onEditScenario'>  /**
</span>  	* Handles a request to edit a {Phoenix.model.Scenario} model.
  */

  onEditScenario: function(grid, scenario, row, rowIndex, event) {
    return this.getScenarioContext().scenarioOpened(scenario);
  },
<span id='Phoenix-controller-ScenarioGridController-method-onActionColumnClick'>  /**
</span>  	* Handles a click on the grid's action column.
  */

  onActionColumnClick: function(view, cell, rowIndex, columnIndex, event, scenario, row) {
    return Ext.MessageBox.confirm(&quot;Confirm&quot;, &quot;Are you sure you want to delete the this Scenario: &quot; + (scenario.get(&quot;name&quot;)), function(button) {
      if (button === &quot;yes&quot;) {
        return this.deleteScenario(scenario);
      }
    }, this);
  }
});
</pre>
</body>
</html>
