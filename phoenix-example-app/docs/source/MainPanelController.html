<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>The source code</title>
  <link href="../resources/prettify/prettify.css" type="text/css" rel="stylesheet" />
  <script type="text/javascript" src="../resources/prettify/prettify.js"></script>
  <style type="text/css">
    .highlight { display: block; background-color: #ddd; }
  </style>
  <script type="text/javascript">
    function highlight() {
      document.getElementById(location.hash.replace(/#/, "")).className = "highlight";
    }
  </script>
</head>
<body onload="prettyPrint(); highlight();">
  <pre class="prettyprint lang-js">// Generated by CoffeeScript 1.4.0
<span id='Phoenix-controller-MainPanelController'>/**
</span>* Controls the main (root) UI container for the application.
*/

Ext.define(&quot;Phoenix.controller.MainPanelController&quot;, {
  extend: &quot;Phoenix.controller.AbstractPhoenixController&quot;,
  requires: [&quot;Phoenix.view.ScenarioForm&quot;],
<span id='Phoenix-controller-MainPanelController-property-observe'>  observe: {
</span>    scenarioContext: {
      scenarioOpened: &quot;onScenarioOpened&quot;,
      scenarioDeleted: &quot;onScenarioDeleted&quot;
    }
  },
<span id='Phoenix-controller-MainPanelController-property-control'>  control: {
</span>    view: {
      boxready: &quot;loadInitialData&quot;
    }
  },
<span id='Phoenix-controller-MainPanelController-method-init'>  init: function() {
</span>    return this.callParent(arguments);
  },
<span id='Phoenix-controller-MainPanelController-method-loadInitialData'>  /**
</span>  	* Loads the initial reference dta.
  */

  loadInitialData: function() {
    var _this = this;
    this.getView().setLoading(true);
    return this.getScenarioService().loadInitialData().then({
      success: function() {
        return _this.getScenarioContext().initialDataLoaded();
      },
      failure: function(errorMessage) {
        return _this.getNotificationService().error(&quot;Error&quot;, errorMessage);
      }
    }).always(function() {
      return _this.getView().setLoading(false);
    });
  },
<span id='Phoenix-controller-MainPanelController-method-onScenarioOpened'>  /**
</span>  	* Responds when a {Phoenix.model.Scenario} view is opened.
  	* @param {Phoenix.model.Scenario} Scenario being opened.
  */

  onScenarioOpened: function(scenario) {
    var existingScenarioPanel;
    existingScenarioPanel = this.findExistingTab(scenario);
    if ((existingScenarioPanel != null)) {
      return existingScenarioPanel.show();
    } else {
      return this.getView().add({
        xtype: &quot;phoenix-view-scenarioForm&quot;,
        itemId: &quot;scenarioPanel_&quot; + (scenario.getId()),
        title: scenario.get(&quot;name&quot;),
        closable: true,
        scenario: scenario
      }).show();
    }
  },
<span id='Phoenix-controller-MainPanelController-method-onScenarioDeleted'>  /**
</span>  	* Responds when a {Phoenix.model.Scenario} is deleted.
  	* @param {Phoenix.model.Scenario} Scenario being deleted.
  */

  onScenarioDeleted: function(scenario) {
    var existingScenarioPanel;
    existingScenarioPanel = this.findExistingTab(scenario);
    if (existingScenarioPanel != null) {
      return existingScenarioPanel.close();
    }
  },
<span id='Phoenix-controller-MainPanelController-method-findExistingTab'>  /**
</span>  	* Locates a view for the specified {Phoenix.model.Scenario}. If not view is open, returns null.
  	* @param {Phoenix.model.Scenario} Scenario to locate a view for.
  	* @return {Phoenix.view.ScenarioForm}
  */

  findExistingTab: function(scenario) {
    return this.getView().child(&quot;#scenarioPanel_&quot; + (scenario.getId()));
  }
});
</pre>
</body>
</html>
